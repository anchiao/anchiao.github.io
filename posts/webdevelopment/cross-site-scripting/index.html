<!doctype html><html><head><title>Common Cross Site Scripting(XSS) and ways to prevent it</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600"><link rel=stylesheet href=/fontawesome/css/all.min.css><link rel=icon type=image/png href=/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png><meta property="og:title" content="Common Cross Site Scripting(XSS) and ways to prevent it"><meta property="og:description" content="introduction of Cross Site Scripting(XSS) and how to prevent it"><meta property="og:type" content="article"><meta property="og:url" content="https://anchiao.github.io/posts/webdevelopment/cross-site-scripting/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-15T10:57:25+08:00"><meta property="article:modified_time" content="2021-09-15T10:57:25+08:00"><meta name=description content="introduction of Cross Site Scripting(XSS) and how to prevent it"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png alt=Logo>
JOANNE</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/posts/java/>JAVA</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/java/codingtest/>coding test</a><ul><li><a href=/posts/java/codingtest/getmostvisited/ title=getMostVisited>getMostVisited</a></li><li><a href=/posts/java/codingtest/parkingbill/ title=ParkingBill>ParkingBill</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/java/ftp/>File Transfer</a><ul><li><a href=/posts/java/ftp/uploadanddownloadfilebysftp/ title="Upload and Download a File by SFTP">Upload and Download a File by SFTP</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/macos-directory/>macOS</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/macos-directory/homebrew/>Homebrew</a><ul><li><a href=/posts/macos-directory/homebrew/homebrew-installation/ title="Homebrew Installation Troubleshooting">Homebrew Installation Troubleshooting</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/sql/>SQL</a><ul><li><a href=/posts/sql/largedata/ title="Insert Large Data">Insert Large Data</a></li><li><a href=/posts/sql/mssql/temp-table/ title="MSSQL temporary table">MSSQL temporary table</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/webdevelopment/>Web Development</a><ul class=active><li><a class=active href=/posts/webdevelopment/cross-site-scripting/ title="Cross-Site Scripting(XSS)">Cross-Site Scripting(XSS)</a></li><li><a href=/posts/webdevelopment/static-site-generator/ title="Hugo - basic commands and hosting">Hugo - basic commands and hosting</a></li><li><a href=/posts/webdevelopment/firefox-mime/ title="Troubleshooting for Firefox showing error while downloading .xlsx file">Troubleshooting for Firefox showing error while downloading .xlsx file</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://anchiao.github.io/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/Joanne_hub039da768100b2ab731d4a109ae337e0_28498_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Joanne Chang</h5></div><div class=title><h1>Common Cross Site Scripting(XSS) and ways to prevent it</h1></div><div class=post-content id=post-content><p>Cross-site Scripting (XSS) is a client-side code injection attack. It&rsquo;s one of the most commonly seen website attacks, even Facebook and Google has been exposed having XSS vulnerabilities.</p><p>If successful, XSS vulnerabilities can be exploited to manipulate or steal cookies, create requests that can be mistaken for those of a valid user, compromise confidential information, or execute malicious code on end-user systems.</p><p>As a web developer, it&rsquo;s better to know how it works and avoid using those codes than to revise the project after the vulnerabilities being detected or targeted. There are many kinds of XSS attacks often injecting through HTML, JavaScript, CSS, XML and URL. Here are some basic attacks and the solutions to fix them.</p><h2 id=basic-xss-attack->Basic XSS attack üëæ</h2><p>the malicious payload can be embedded in a URL (e.g. in query strings of GET requests). An attacker can trick a victim, via a phishing attack, to click on a link with vulnerable input which has been altered to include attack code and sent to the legitimate server. The injected code is then reflected to the user&rsquo;s browser which executes it.
A malicious payload might look like this in input that requires for the URL:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>http:<span style=color:#75715e>//example.com/test=&lt;script&gt;alert(&#39;xss payload&#39;);&lt;/script&gt;
</span></span></span></code></pre></div><p>another type of attacks doesn&rsquo;t use script tags at all, but instead uses an embedded tag with a javascript attribute:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>http:<span style=color:#75715e>//example.com/test= &lt;img src=javascript:alert(&#39;xss payload&#39;)/&gt;
</span></span></span></code></pre></div><p>Converting tags to URL encode could be a tricky one, cause it&rsquo;s not that obvious to find out, it looks just like a normal URL:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>%</span><span style=color:#ae81ff>3</span>Cscript<span style=color:#f92672>%</span><span style=color:#ae81ff>3</span>Ealert<span style=color:#f92672>(%</span><span style=color:#ae81ff>27</span>You<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>have<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>been<span style=color:#f92672>%</span><span style=color:#ae81ff>20</span>hacked<span style=color:#f92672>%</span><span style=color:#ae81ff>27</span><span style=color:#f92672>)%</span><span style=color:#ae81ff>3</span>B<span style=color:#f92672>%</span><span style=color:#ae81ff>3</span>C<span style=color:#f92672>%</span><span style=color:#ae81ff>2F</span>script<span style=color:#f92672>%</span><span style=color:#ae81ff>3</span>E
</span></span></code></pre></div><p>if decoding that URL you&rsquo;ll see it actually represents <code>&lt;script>alert('You have been hacked');&lt;/script></code> (you can easily encode/decode any characters in website like <a href=http://meyerweb.com/eric/tools/dencoder/>Encoder</a>)</p><p>The attack happens if the browser or the application decodes that URL and renders it, whereas if the page treats the payload in the same URL syntax, there won&rsquo;t be an XSS.</p><h2 id=2-how-to-prevent-xss->2. How to prevent XSS üôÜ‚Äç‚ôÄÔ∏è</h2><p>When developing web application, it&rsquo;s important to design the system to never assume user input is valid or &ldquo;clean&rdquo;. Ensure proper filtration and encode user-supplied data is recommended.</p><h3 id=1validating-all-input>1.Validating all input</h3><p>When validating a form, verify that all inputs match the strictest definition of valid value, do this at both frontend and backend programs for better protection, because an attacker can easily &ldquo;disabled javascript&rdquo; on the browser, so the frontend validation won&rsquo;t be functioning.</p><h4 id=example-of-using-jquery-validation-api>Example of using JQuery Validation API</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>$</span>(document).<span style=color:#a6e22e>ready</span>(<span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#34;#register-form&#34;</span>).<span style=color:#a6e22e>validate</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>rules</span> <span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;userName&#34;</span> <span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>required</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>englishNumberValidate</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>invalidHandler</span><span style=color:#f92672>:</span><span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>e</span>,<span style=color:#a6e22e>validator</span>){
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;<span style=color:#a6e22e>i</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>validator</span>.<span style=color:#a6e22e>errorList</span>.<span style=color:#a6e22e>length</span>;<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>id</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>validator</span>.<span style=color:#a6e22e>errorList</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>id</span>;
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#&#39;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>id</span>).<span style=color:#a6e22e>val</span>(<span style=color:#e6db74>&#34;&#34;</span>); <span style=color:#75715e>//clear out inappropriate value
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>     }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>validator</span>.<span style=color:#a6e22e>addMethod</span>(<span style=color:#e6db74>&#34;englishNumberValidate&#34;</span>,
</span></span><span style=display:flex><span> <span style=color:#a6e22e>englishNumberValidate</span>,<span style=color:#e6db74>&#34;Please insert English or Numbers only&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>englishNameValidate</span>(<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>element</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>optional</span>(<span style=color:#a6e22e>element</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>reg</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RegExp(<span style=color:#e6db74>&#34;^[a-zA-Z]+([ ][a-zA-Z]+)*$&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>result</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>reg</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>value</span>)) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jQuery</span>(<span style=color:#a6e22e>element</span>).<span style=color:#a6e22e>val</span>(<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>toUpperCase</span>());
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/script&gt;</span>
</span></span></code></pre></div><p>For the frontend, <a href=https://github.com/jquery-validation/jquery-validation>jQuery Validation Plugin</a> creates a custom validation for your inputs. Make sure after validating, inappropriate values should not remain in the input, clear them out or the browser might render it while refreshing the page, doing this could prevent malicious payload that is URL encoded.</p><h4 id=example-of-using-hibernate-validator>Example of using Hibernate Validator</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/** Register Entity */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Id</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Column</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;UserId&#34;</span><span style=color:#f92672>,</span> unique <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span> nullable <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>,</span> length <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Length</span><span style=color:#f92672>(</span>max<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span><span style=color:#f92672>,</span>message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Maximum length of Id is 50 characters&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Pattern</span><span style=color:#f92672>(</span>regexp<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;^[\\w.]+$&#34;</span><span style=color:#f92672>,</span>message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Only English, numbers and &#34;</span>_<span style=color:#e6db74>&#34; &#34;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34; is allowed&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getUserId</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>userId</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span></code></pre></div><p>For backend validation, <a href=https://docs.jboss.org/hibernate/stable/validator/api/>this API</a> is useful as it contains constraint annotations like <code>@NotNull</code>, <code>@Size</code> and <code>@Min</code>,<code>@Max</code>, just use them for setting the rules to pass the validation of each input.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/** Register Controller */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@PostMapping</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>register</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Validated</span> <span style=color:#a6e22e>@ModelAttribute</span> UserDef userdef<span style=color:#f92672>,</span> BindingResult bindingResult<span style=color:#f92672>,</span> HttpSession session<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>            RedirectAttributes redirectAttributes<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> isCaptchaValid <span style=color:#f92672>=</span> captchaService<span style=color:#f92672>.</span><span style=color:#a6e22e>isValidate</span><span style=color:#f92672>(</span>session<span style=color:#f92672>,</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span> <span style=color:#f92672>!</span>isCaptchaValid <span style=color:#f92672>||</span> bindingResult<span style=color:#f92672>.</span><span style=color:#a6e22e>hasErrors</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            StringBuilder errSb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Error ColumnsÔºö&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>bindingResult<span style=color:#f92672>.</span><span style=color:#a6e22e>hasErrors</span><span style=color:#f92672>()){</span>
</span></span><span style=display:flex><span>                bindingResult<span style=color:#f92672>.</span><span style=color:#a6e22e>getFieldErrors</span><span style=color:#f92672>().</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>f <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    errSb<span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>f<span style=color:#f92672>.</span><span style=color:#a6e22e>getDefaultMessage</span><span style=color:#f92672>()).</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\\n&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>//clear out inappropriate value
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        BeanUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>setProperty</span><span style=color:#f92672>(</span>userdef<span style=color:#f92672>,</span> f<span style=color:#f92672>.</span><span style=color:#a6e22e>getField</span><span style=color:#f92672>(),</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        LOGGER<span style=color:#f92672>.</span><span style=color:#a6e22e>error</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Reset field({}) value fail.&#34;</span><span style=color:#f92672>,</span> f<span style=color:#f92672>.</span><span style=color:#a6e22e>getField</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            redirectAttributes<span style=color:#f92672>.</span><span style=color:#a6e22e>addFlashAttribute</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;user&#34;</span><span style=color:#f92672>,</span>userdef<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            redirectAttributes<span style=color:#f92672>.</span><span style=color:#a6e22e>addFlashAttribute</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;regErrMsg&#34;</span><span style=color:#f92672>,</span>errSb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;redirect:/register&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span></code></pre></div><p>In the controller class, Use <code>BindingResult.hasErrors()</code> to validate if the input(column) matches what you&rsquo;ve set in the entity, use <code>getDefaultMessage()</code> to get the custom message and save it as a String, then return it using <code>redirectAttributes</code> to writes it to the page.</p><h3 id=2encode-all-input>2.Encode all input</h3><p>Character include <code>&lt;</code>,<code>></code>,<code>&</code>,<code>"</code>,<code>'</code> should be encoded to special hexadecimal digits to prevent switching into any execution context, such as script and style. <a href=https://emn178.github.io/online-tools/html_encode.html>HTML Encode</a> is designed for this purpose, for example, it converts <code>&lt;</code> to &amp;lt, when rendering on client-side, &amp;lt will be automatically transformed to <code>&lt;</code>.</p><p>There are many functions or APIs to do HTML Encode, like <code>escapeHtml()</code>and<code>htmlspecialchars()</code> for javaScript; As for backend, Java has <a href=https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/StringEscapeUtils.html>org.apache.commons.text.StringEscapeUtils</a> library which could escapes and unescapes special characters for Java, JavaScript, HTML and XML.</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/anchiao/anchiao.github.io/edit/main/content/posts/WebDevelopment/Cross-Site%20Scripting/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/sql/mssql/temp-table/ title="MSSQL temporary table" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>MSSQL temporary table</div></a></div><div class="col-md-6 next-article"><a href=/posts/webdevelopment/static-site-generator/ title="Hugo - basic commands and hosting" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Hugo - basic commands and hosting</div></a></div></div><hr><script src=https://giscus.app/client.js data-repo=anchiao/anchiao.github.io data-repo-id=R_kgDOHD-W2w data-category=Announcements data-category-id=DIC_kwDOHD-W284COi8H data-mapping=url data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=light_high_contrast data-lang crossorigin=anonymous async></script></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ol><li><a href=#basic-xss-attack->Basic XSS attack üëæ</a></li><li><a href=#2-how-to-prevent-xss->2. How to prevent XSS üôÜ‚Äç‚ôÄÔ∏è</a><ol><li><a href=#1validating-all-input>1.Validating all input</a><ol><li><a href=#example-of-using-jquery-validation-api>Example of using JQuery Validation API</a></li><li><a href=#example-of-using-hibernate-validator>Example of using Hibernate Validator</a></li></ol></li><li><a href=#2encode-all-input>2.Encode all input</a></li></ol></li></ol></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://anchiao.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://anchiao.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://anchiao.github.io#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://anchiao.github.io#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:anchiao0417@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>anchiao0417@gmail.com</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4></div><div class="col-md-4 text-center">¬© 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>