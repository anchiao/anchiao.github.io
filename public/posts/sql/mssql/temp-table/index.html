<!DOCTYPE html>
<html>
  <head>
    <title>MSSQL temporary table</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>
<link rel="stylesheet" href="/css/flag-icon.min.css"/>


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600">


<link rel="stylesheet" href="/fontawesome/css/all.min.css"/>




  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" />

<meta property="og:title" content="MSSQL temporary table" />
<meta property="og:description" content="introduction of basic use for MSSQL temorary table" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://anchiao.github.io/posts/sql/mssql/temp-table/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-24T08:06:25+06:00" />
<meta property="article:modified_time" content="2021-06-24T08:06:25+06:00" />


    
    
<meta name="description" content="introduction of basic use for MSSQL temorary table" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/css/layouts/single.css"/>
<link rel="stylesheet" href="/css/navigators/sidebar.css">

<link rel="stylesheet" href="/css/style.css"/>



    




</head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      
        <img src="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" alt="Logo">
      Anchiao</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  
    <img src="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/java/">JAVA</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/java/codingtest/">coding test</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/java/codingtest/getmostvisited/" title="getMostVisited">getMostVisited</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/java/codingtest/parkingbill/" title="ParkingBill">ParkingBill</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/java/ftp/">File Transfer</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/java/ftp/uploadanddownloadfilebysftp/" title="Upload and Download a File by SFTP">Upload and Download a File by SFTP</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/macos-directory/">macOS</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/macos-directory/homebrew/">Homebrew</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/macos-directory/homebrew/homebrew-installation/" title="Homebrew Installation Troubleshooting">Homebrew Installation Troubleshooting</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
    
    
  
  
    
    <li>
      <i class="fas fa-minus-circle"></i><a class="active" href="/posts/sql/">SQL</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/sql/largedata/" title="Insert Large Data">Insert Large Data</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/sql/mssql/temp-table/" title="MSSQL temporary table">MSSQL temporary table</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/webdevelopment/">Web Development</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/webdevelopment/cross-site-scripting/" title="Cross-Site Scripting(XSS)">Cross-Site Scripting(XSS)</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/webdevelopment/firefox-mime/" title="Troubleshooting for Firefox showing error while downloading .xlsx file">Troubleshooting for Firefox showing error while downloading .xlsx file</a></li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(https://anchiao.github.io/images/default-hero.jpg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/ac_hu5063d2e2b293578c80a890c158307f2c_22290_120x120_fit_box_3.png' alt="Author Image">
          <h5 class="author-name">Anchiao Chang (Joanne) </h5>
          <p>Thursday, June 24, 2021</p>
        </div>

        <div class="title">
          <h1>MSSQL temporary table</h1>
        </div>
        
        <div class="post-content" id="post-content">
          <p>Temporary tables are used to store data temporarily and they can perform CRUD (Create, Read, Update, and Delete), join, and some other operations like the persistent database tables, which gives us more flexibility to get the info we want from the database.
SQL Server supports a few types of temporary tables by using <code>#</code>, <code>##</code> or <code>@</code> before the table name, they exist for a different session.</p>
<h2 id="1using-temptable">1.Using #TempTable</h2>
<p>a single hashtag (#) sign before the table name indicates a local temporary table, it&rsquo;s available ONLY to the session that created it and is dropped when the session is closed, use it when you need the table to be visible only in the current session.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">INTO</span> <span style="color:#f92672">#</span>TableName <span style="color:#66d9ef">FROM</span> TableName <span style="color:#66d9ef">where</span> ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> <span style="color:#f92672">#</span>TableName
</span></span></code></pre></div><p>Another way to create it is to use create table command then use insert and select command to make a copy of the table we want.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">#</span>TableName (
</span></span><span style="display:flex;"><span>    Column1 int <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> <span style="color:#66d9ef">IDENTITY</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>    Column2 varchar(<span style="color:#ae81ff">255</span>),
</span></span><span style="display:flex;"><span>    Column3 varchar(<span style="color:#ae81ff">255</span>),
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#f92672">#</span>TableName (Column1,Column2)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> Column1,Column1
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span>  OtherTable
</span></span></code></pre></div><p>This way, the temptable is stored in tempdb, you can check that by using</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> tempdb.dbo.<span style="color:#f92672">#</span>TableName
</span></span></code></pre></div><p>It&rsquo;s better to drop the table once we finish the process rather than waiting for the system to drop it out.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">#</span>TableName
</span></span></code></pre></div><p>or use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">EXISTS</span> <span style="color:#f92672">#</span>TableName
</span></span></code></pre></div><p>While we can&rsquo;t create a temporary table if it already exists, this command is safe to use before creating one, as it DROP TABLE if it exists, and ignored if not, executing this command will do both for you in one line.</p>
<h2 id="2using-temptable">2.Using ##TempTable</h2>
<p>With double hashtag (##) before the table name means it&rsquo;s a global temporary table, which is available to ALL sessions, but is still dropped when the session that created it is closed and all other references to them are closed. Ways of creating it are the same.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">INTO</span> <span style="color:#f92672">#</span>TableName <span style="color:#66d9ef">FROM</span> TableName <span style="color:#66d9ef">where</span> ...
</span></span></code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">##</span>TableName (
</span></span><span style="display:flex;"><span>    Column1 int <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> <span style="color:#66d9ef">IDENTITY</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>    Column2 varchar(<span style="color:#ae81ff">255</span>),
</span></span><span style="display:flex;"><span>    Column3 varchar(<span style="color:#ae81ff">255</span>),
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#f92672">##</span>TableName (Column1,Column2)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> Column1,Column2
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> OtherTable
</span></span></code></pre></div><p>Also, be careful to drop it after use.</p>
<h2 id="3using-temptable">3.Using @TempTable</h2>
<p>A @ sign before table name is called Table Variable, it resides in the tempdb database as well but is accessible only within the session that created it. Meaning we have to do the crud in one session, once the command is executed, this Table Variable will be dropped automatically, which means there&rsquo;s no need to drop it at all. Table variables are better to use with small amounts of data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">DECLARE</span> <span style="color:#f92672">@</span>TableName <span style="color:#66d9ef">AS</span> <span style="color:#66d9ef">TABLE</span> 
</span></span><span style="display:flex;"><span>(Column1 INT <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span>,
</span></span><span style="display:flex;"><span> Column2 INT <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#f92672">@</span>TableName( Column1, Column2 )
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">SELECT</span>
</span></span><span style="display:flex;"><span>  Column1,
</span></span><span style="display:flex;"><span>  Column2 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dbo.OtherTable 
</span></span></code></pre></div><h3 id="references">References</h3>
<p><a href="https://www.sqlshack.com/when-to-use-temporary-tables-vs-table-variables/">When to Use SQL Temp Tables vs. Table Variables</a></p>
<p><a href="https://www.sqlshack.com/overview-and-performance-tips-of-temp-tables-in-sql-server/">Overview and Performance Tips of Temp Tables in SQL Server</a></p>

        </div>

        
        <div class="row pl-3 pr-3">
        
        <div class="col-md-6 share-buttons">
        
          </div>

        
        
          
            
          
          <div class="col-md-6 btn-improve-page">
             
               <a href="https://github.com/anchiao/anchiao.github.io/edit/main/content/posts/SQL/MSSQL/temp%20table/index.md" title="Improve this page" target="_blank" rel="noopener">
            
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        
        </div>



      
      <hr />
        







  





  
  

  
  

  
  

  
  

  
  

  
    
    
  
  

  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/sql/largedata/" title="Insert Large Data Manually To Avoid Timeout" class="btn btn-outline-info">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">Insert Large Data Manually To Avoid Timeout</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="/posts/webdevelopment/cross-site-scripting/" title="Common Cross Site Scripting(XSS) and ways to prevent it" class="btn btn-outline-info">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">Common Cross Site Scripting(XSS) and ways to prevent it</div>
        </a>
      </div>
    
</div>

      <hr />

      
      
        
          
          
              










<script src="https://giscus.app/client.js"
        data-repo="anchiao/anchiao.github.io"
        data-repo-id="R_kgDOHD-W2w"
        data-category="Announcements"
        data-category-id="DIC_kwDOHD-W284COi8H"
        data-mapping="url"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light_high_contrast"
        data-lang=""
        crossorigin="anonymous"
        async>
</script>

          
        
      
      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn"><i class="fas fa-chevron-circle-up"></i></a>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center pl-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ol>
    <li><a href="#1using-temptable">1.Using #TempTable</a></li>
    <li><a href="#2using-temptable">2.Using ##TempTable</a></li>
    <li><a href="#3using-temptable">3.Using @TempTable</a>
      <ol>
        <li><a href="#references">References</a></li>
      </ol>
    </li>
  </ol>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    










  
    
  



  
  
    
  

  
  
    
  

  
  

  
  
    
    
      
    
  


  
  
  

  

  








  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#about">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#experiences">Experiences</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#recent-posts">Recent Posts</a>
                </li>
              
            
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:anchiao0417@gmail.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>anchiao0417@gmail.com</span>
                </a></li>
              
            
          </ul>
        </div>
        
        
        
          
          <div class="col-md-4 col-sm-12">
            <p>Stay up to date with email notification</p>
            
              <form method='post' action='https://blogtrottr.com'>
              <div class="form-group">
              <input type='email' class="form-control" name='btr_email' placeholder="Enter email"/><br />
              <input type='hidden' name='btr_url' value='https://anchiao.github.ioindex.xml' />
              <input type='hidden' name='schedule_type' value='1' />
              <small id="emailHelp" class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small>
              <button type="submit" class="btn btn-info"> Submit </button>
              </div>
              </form>
            
          </div>
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">




        </div>
        <div class="col-md-4 text-center">© 2022 Copyright.</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>









    
</body>
</html>
