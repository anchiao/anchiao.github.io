<!DOCTYPE html>
<html>
  <head>
    <title>Upload and Download File by SFTP</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>
<link rel="stylesheet" href="/css/flag-icon.min.css"/>


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600">


<link rel="stylesheet" href="/fontawesome/css/all.min.css"/>




  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" />

<meta property="og:title" content="Upload and Download File by SFTP" />
<meta property="og:description" content="write Java code that uploads a file from local computer to a remote SFTP server, or download a file from remote server to local directory" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://anchiao.github.io/posts/java/ftp/uploadanddownloadfilebysftp/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-06T08:06:25+06:00" />
<meta property="article:modified_time" content="2021-07-06T08:06:25+06:00" />


    
    
<meta name="description" content="write Java code that uploads a file from local computer to a remote SFTP server, or download a file from remote server to local directory" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/css/layouts/single.css"/>
<link rel="stylesheet" href="/css/navigators/sidebar.css">

<link rel="stylesheet" href="/css/style.css"/>



    




</head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      
        <img src="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" alt="Logo">
      JOANNE</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  
    <img src="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/planet_hu16b6c78e8537341cfc427575be072062_223980_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
    
    
  
  
    
    <li>
      <i class="fas fa-minus-circle"></i><a class="active" href="/posts/java/">JAVA</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/java/codingtest/">coding test</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/java/codingtest/getmostvisited/" title="getMostVisited">getMostVisited</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/java/codingtest/parkingbill/" title="ParkingBill">ParkingBill</a></li>
  


      </ul>
    </li>
  

  
  
  
  
    
    
  
  
    
    <li>
      <i class="fas fa-minus-circle"></i><a class="active" href="/posts/java/ftp/">File Transfer</a>
      
      <ul class="active">
        
  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/java/ftp/uploadanddownloadfilebysftp/" title="Upload and Download a File by SFTP">Upload and Download a File by SFTP</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/macos-directory/">macOS</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/macos-directory/homebrew/">Homebrew</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/macos-directory/homebrew/homebrew-installation/" title="Homebrew Installation Troubleshooting">Homebrew Installation Troubleshooting</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/sql/">SQL</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/sql/largedata/" title="Insert Large Data">Insert Large Data</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/sql/mssql/temp-table/" title="MSSQL temporary table">MSSQL temporary table</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/webdevelopment/">Web Development</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/webdevelopment/cross-site-scripting/" title="Cross-Site Scripting(XSS)">Cross-Site Scripting(XSS)</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/webdevelopment/static-site-generator/" title="Hugo - basic commands and hosting">Hugo - basic commands and hosting</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/webdevelopment/firefox-mime/" title="Troubleshooting for Firefox showing error while downloading .xlsx file">Troubleshooting for Firefox showing error while downloading .xlsx file</a></li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(https://anchiao.github.io/images/default-hero.jpg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/Joanne_hub039da768100b2ab731d4a109ae337e0_28498_120x120_fit_box_3.png' alt="Author Image">
          <h5 class="author-name">Joanne Chang</h5>
          
        </div>

        <div class="title">
          <h1>Upload and Download File by SFTP</h1>
        </div>
        
        <div class="post-content" id="post-content">
          <p>When data is sent to another party, it&rsquo;s potentially exposed to outside entities on the Internet, FTP and SFTP are two common file transfer options, Learning more about them will make a proper choice for sharing your company’s data.</p>
<h2 id="ftp-vs-sftp">FTP v.s SFTP</h2>
<p>FTP is file transfer protocol. It&rsquo;s a simple way of transferring data, making data readable for anyone who intercepts it. While this is fine if you’re just sending unimportant files.</p>
<p>SFTP is Secure File Transfer Protocol, it means what it says, safer than FTP.
SFTP uses SSH (or secure shell) encryption to protect data from opening to potential breaches and compromises to the company.</p>
<h2 id="example">Example</h2>
<p>We can upload or download any files, including a text, a pictrure or audios by FTP and SFTP.
Here&rsquo;s the demonstration of how to do code it. First let&rsquo;s put JSch dependency in pom.xml so we can integrate its functionality into Java programs.</p>
<pre tabindex="0"><code>&lt;dependency&gt;
	&lt;groupId&gt;com.jcraft&lt;/groupId&gt;
	&lt;artifactId&gt;jsch&lt;/artifactId&gt;
	&lt;version&gt;0.1.55&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><h2 id="download-file">Download File</h2>
<p>import the following classes</p>
<pre tabindex="0"><code>import com.jcraft.jsch.Channel;
import com.jcraft.jsch.ChannelSftp;
import com.jcraft.jsch.JSch;
import com.jcraft.jsch.JSchException;
import com.jcraft.jsch.Session;
import com.jcraft.jsch.SftpException;
</code></pre><p>Instantiates the Session object with given username, host and port.
This Session represents a connection to a SSH server. One session can contain multiple Channels of various types, created with openChannel(), opened with connect() and closed with disconnect().</p>
<pre tabindex="0"><code>        Session session = null;
        Channel channel = null;

        //Your Custom connection infos, usually encapsulate these infos inside a bean
        String UserId = &#34;myId&#34;;
        String host = &#34;10.10.10.10&#34;;
        int port = 22;
        String password = &#34;myPwd&#34;;
        String remotePath = &#34;/home/myRemotePath&#34;;
        String remoteFileName = &#34;myFile&#34;;
        String localDownloadFolder = &#34;C:/downloads&#34;;

        try {
            JSch jsch = new JSch();
            session = jsch.getSession(UserId, host, port);

            // connect without verifying SSH host keys
            session.setConfig(&#34;StrictHostKeyChecking&#34;, &#34;no&#34;);
            session.setPassword(password);
            session.connect();

            channel = session.openChannel(&#34;sftp&#34;);
            channel.connect();
            ChannelSftp channelSftp = (ChannelSftp) channel;

            channelSftp.cd(remotePath);

            int download_index = 0;
                try {
                     channelSftp.get(remoteFileName, localDownloadFolder);
                    } catch (SftpException sftpException) {
                     LOGGER.error(&#34;Download file fail.&#34; , sftpException);
                   } 
        } catch (Exception exception) {
            LOGGER.error(&#34;------ Sftp download file fail.&#34; ,exception);
            throw exception;
        } finally {
            // close SFTP
            channelSftp.exit();
            SftpUtils.clodeSftpConnection(channel,session);
        }
    
</code></pre><h2 id="upload-file">Upload File</h2>
<p>For uploading file, 2 more imports are needed</p>
<pre tabindex="0"><code>import java.io.File;
import java.io.FileInputStream;
</code></pre><p>The code cover up most of the exceptions might encounter while uploading with try catch blocks and loggers.</p>
<pre tabindex="0"><code>        Session session = null;
        Channel channel = null;
        //Your Custom connection infos, usually encapsulate these infos inside a bean
        String UserId = &#34;myId&#34;;
        String host = &#34;10.10.10.10&#34;;
        int port = 22;
        String password = &#34;myPwd&#34;;
        String remotePath = &#34;/home/myRemotePath&#34;;
        String localFilePath = &#34;C:/downloads/file.txt&#34;;

        File uploadFile = new File(localFilePath);
        String uploadFileName = uploadFile.getName(); //file.txt

        try (FileInputStream fis = new FileInputStream(uploadFile)) {
            JSch jsch = new JSch();
            session = jsch.getSession(UserId, host, port);

            // connect without verifying SSH host keys
            session.setConfig(&#34;StrictHostKeyChecking&#34;, &#34;no&#34;);
            session.setPassword(password);
            session.connect();

            channel = session.openChannel(&#34;sftp&#34;);
            channel.connect();
            ChannelSftp channelSftp = (ChannelSftp) channel;

            try {
                channelSftp.mkdir(remotePath);

            } catch (SftpException sftpException) {
                if(!StringUtils.equals(&#34;Failure&#34;,sftpException.getMessage())){
                    LOGGER.error(&#34;fail to create SFTP direcrory , reason is {} &#34;,sftpException);
                }
            }
            // combine remoteFilePath and fileName
            String remoteFileEntirePath = remotePath + &#34;/&#34; + uploadFileName;
            LOGGER.info(&#34;*** Entire path of remote file is = {}&#34;, remoteFileEntirePath);
            channelSftp.put(fis, remoteFileEntirePath, ChannelSftp.OVERWRITE);
            LOGGER.info(&#34;======&gt;Upload Success!&#34;);
        } catch (Exception exception) {
            LOGGER.error(&#34;upload file to remote ftp fail.&#34;, exception);
        } finally {
            //close SFTP connection
            try {
                if(channel!=null &amp;&amp; channel.isConnected()){
                    channel.disconnect();
                    LOGGER.debug(&#34;Disconnect channel =&gt; {}&#34;,!channel.isConnected() );
                    LOGGER.debug(&#34;Close channel =&gt; {}&#34;,channel.isClosed());
                }
                if(session!=null &amp;&amp; session.isConnected()){
                    session.disconnect();
                    LOGGER.debug(&#34;Disconnect session =&gt; {}&#34;,!session.isConnected());
                }
            } catch (Exception exception) {
                LOGGER.error(&#34;------ Closed Sftp fail.&#34;, exception);
            }
        }

    }
</code></pre>
        </div>

        
        <div class="row pl-3 pr-3">
        
        <div class="col-md-6 share-buttons">
        
          </div>

        
        
          
            
          
          <div class="col-md-6 btn-improve-page">
             
               <a href="https://github.com/anchiao/anchiao.github.io/edit/main/content/posts/JAVA/FTP/UploadandDownloadFilebySFTP/index.md" title="Improve this page" target="_blank" rel="noopener">
            
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        
        </div>



      
      <hr />
        







  





  
  

  
  

  
    
    
  
  

  
  

  
  

  
  

  
  

  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/java/codingtest/parkingbill/" title="ParkingBill" class="btn btn-outline-info">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">ParkingBill</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="/posts/macos-directory/homebrew/homebrew-installation/" title="How to solve Homebrew installation failure?" class="btn btn-outline-info">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">How to solve Homebrew installation failure?</div>
        </a>
      </div>
    
</div>

      <hr />

      
      
        
          
          
              










<script src="https://giscus.app/client.js"
        data-repo="anchiao/anchiao.github.io"
        data-repo-id="R_kgDOHD-W2w"
        data-category="Announcements"
        data-category-id="DIC_kwDOHD-W284COi8H"
        data-mapping="url"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light_high_contrast"
        data-lang=""
        crossorigin="anonymous"
        async>
</script>

          
        
      
      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn"><i class="fas fa-chevron-circle-up"></i></a>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center pl-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ol>
    <li><a href="#ftp-vs-sftp">FTP v.s SFTP</a></li>
    <li><a href="#example">Example</a></li>
    <li><a href="#download-file">Download File</a></li>
    <li><a href="#upload-file">Upload File</a></li>
  </ol>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    










  
      
  



  
  
    
  

  
  
    
  

  
  

  
  
    
    
      
    
  


  
  
  

  

  








  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#about">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#skills">Skills</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#experiences">Experiences</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#projects">Projects</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://anchiao.github.io#recent-posts">Recent Posts</a>
                </li>
              
            
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:anchiao0417@gmail.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>anchiao0417@gmail.com</span>
                </a></li>
              
            
          </ul>
        </div>
        
        
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">




        </div>
        <div class="col-md-4 text-center">© 2023 Copyright.</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>









    
</body>
</html>
